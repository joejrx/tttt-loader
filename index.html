<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TTTT Prototype – Canonical Order</title>

  <style>
    body { font-family: Arial, sans-serif; padding: 40px; line-height: 1.45; }
    .small { color:#555; }
    .status{
      display:inline-block; padding:10px 12px; border-radius:8px; margin: 10px 0 18px;
      font-weight: 800;
    }
    .ok { background:#d4edda; color:#155724; }
    .warn { background:#ffeeba; color:#7a5a00; }
    .bad { background:#f8d7da; color:#721c24; }

    .wrap { overflow-x:auto; -webkit-overflow-scrolling: touch; }
    table { width: 100%; border-collapse: collapse; min-width: 1100px; }
    th, td { border: 1px solid #ccc; padding: 8px 10px; vertical-align: top; }
    th { background:#efefef; position: sticky; top: 0; z-index: 2; }
    td.num, th.num { text-align: right; font-variant-numeric: tabular-nums; white-space: nowrap; }
    td.txt, th.txt { text-align: left; }
  </style>
</head>

<body>
  <h1>TTTT Prototype (Canonical TTTT Order)</h1>
  <p class="small">
    Baked-in sample rows • Sort: <b>Total Terpenes</b> (desc), then <b>BetaCaryphyllene</b> (desc)
  </p>

  <div id="jsStatus" class="status warn">JS status: (checking…)</div>

  <div class="wrap">
    <table id="tbl">
      <thead>
        <tr id="hdrRow"></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

<script>
(() => {
  const statusEl = document.getElementById("jsStatus");
  const setStatus = (cls, msg) => {
    statusEl.classList.remove("ok","warn","bad");
    statusEl.classList.add(cls);
    statusEl.textContent = msg;
  };

  try {
    // -----------------------------------------
    // ✅ Canonical terp order from desktop TTTT
    // (exact order as you pasted)
    // -----------------------------------------
    const terpColumns = [
      { key: "BetaCaryphyllene", label: "BetaCaryphyllene" },
      { key: "Limonene", label: "Limonene" },
      { key: "Linalool", label: "Linalool" },
      { key: "BetaMyrcene", label: "BetaMyrcene" },
      { key: "Humulene", label: "Humulene" },
      { key: "Terpinolene", label: "Terpinolene" },
      { key: "BetaPinene", label: "BetaPinene" },
      { key: "AlphaPinene", label: "AlphaPinene" },
      { key: "ThreeCarene", label: "ThreeCarene" },
      { key: "AlphaTerpinene", label: "AlphaTerpinene" },
      { key: "BetaEudesmol", label: "BetaEudesmol" },
      { key: "Bisabolol", label: "Bisabolol" },
      { key: "Camphene", label: "Camphene" },
      { key: "Eucalyptol", label: "Eucalyptol" },
      { key: "Geraniol", label: "Geraniol" },
      { key: "Guaiol", label: "Guaiol" },
      { key: "Isopulegol", label: "Isopulegol" },
      { key: "Nerolidol", label: "Nerolidol" },
      { key: "NerolidolTwo", label: "NerolidolTwo" },
      { key: "Ocimene", label: "Ocimene" },
      { key: "OcimeneOne", label: "OcimeneOne" },
      { key: "OcimeneTwo", label: "OcimeneTwo" },
      { key: "pCymene", label: "pCymene" },
      { key: "pIsopropyltouluene", label: "pIsopropyltouluene" },
      { key: "Terpinene", label: "Terpinene" },
      { key: "TransNerolidol", label: "TransNerolidol" }
    ];

    const terpKeys = terpColumns.map(t => t.key);

    // -----------------------------------------
    // Sample data (baked-in)
    // Use terp keys above; missing values become 0
    // -----------------------------------------
    const data = [
      {
        Product: "Anthos | Walkabout | 14.15g Premium Flower",
        Location: "Farmaceuticalrx (Cuyahoga Falls)",
        "Product Type": "Flower",
        Room: "Sales Floor",
        THC: 25.10,
        BetaCaryphyllene: 0.92,
        Limonene: 0.64,
        Linalool: 0.08,
        BetaMyrcene: 1.07,
        Humulene: 0.36,
        BetaPinene: 0.09,
        AlphaPinene: 0.05,
        Guaiol: 0.16,
        Isopulegol: 0.02
      },
      {
        Product: "Anthos | Walkabout | 1g Live Resin Badder",
        Location: "Farmaceuticalrx (Cuyahoga Falls)",
        "Product Type": "Concentrate",
        Room: "Sales Floor",
        THC: 63.00,
        BetaCaryphyllene: 2.25,
        Limonene: 2.98,
        BetaMyrcene: 1.81,
        Humulene: 0.90,
        Guaiol: 0.41
      },
      {
        Product: "88 Lift | O.V. 2.0 | .84g Rechargable Disposable Vape",
        Location: "Farmaceuticalrx (Cuyahoga Falls)",
        "Product Type": "Vape",
        Room: "Sales Floor",
        THC: 73.90,
        BetaCaryphyllene: 1.05,
        Limonene: 1.51,
        Linalool: 0.41,
        BetaMyrcene: 0.99,
        Humulene: 0.03,
        BetaPinene: 0.28,
        AlphaPinene: 0.16,
        BetaEudesmol: 0.23
      },
      {
        Product: "Anthos | Neon Flamingo | 1g Live Resin Sauce",
        Location: "Farmaceuticalrx (Cuyahoga Falls)",
        "Product Type": "Concentrate",
        Room: "Sales Floor",
        THC: 66.20,
        BetaCaryphyllene: 1.43,
        Limonene: 2.84,
        Linalool: 1.48,
        BetaMyrcene: 0.75,
        Humulene: 0.44
      }
    ];

    // -----------------------------------------
    // Total Terpenes = sum across canonical terp keys
    // (this is the same "addition step" logic)
    // -----------------------------------------
    data.forEach(row => {
      terpKeys.forEach(k => row[k] = Number(row[k] ?? 0) || 0);
      const total = terpKeys.reduce((sum, k) => sum + row[k], 0);
      row["Total Terpenes"] = Number(total.toFixed(2));
    });

    // Sort by Total Terpenes DESC, then BetaCaryphyllene DESC
    data.sort((a, b) => {
      if (b["Total Terpenes"] !== a["Total Terpenes"]) return b["Total Terpenes"] - a["Total Terpenes"];
      return (b.BetaCaryphyllene || 0) - (a.BetaCaryphyllene || 0);
    });

    // Build header row in the exact TTTT order:
    // Product, Location, Product Type, Room, THC, Total Terpenes, then terps
    const hdrRow = document.getElementById("hdrRow");
    hdrRow.innerHTML = `
      <th class="txt">Product</th>
      <th class="txt">Location</th>
      <th class="txt">Product Type</th>
      <th class="txt">Room</th>
      <th class="num">THC</th>
      <th class="num">Total Terpenes</th>
      ${terpColumns.map(t => `<th class="num">${t.label}</th>`).join("")}
    `;

    // Render rows
    const tbody = document.querySelector("#tbl tbody");
    tbody.innerHTML = "";

    const fmtPct = (n) => (Number(n).toFixed(2) + " %");
    const fmtNum = (n) => Number(n).toFixed(2);

    data.forEach(row => {
      const terpCells = terpColumns.map(t => `<td class="num">${fmtPct(row[t.key])}</td>`).join("");
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td class="txt">${row.Product ?? ""}</td>
        <td class="txt">${row.Location ?? ""}</td>
        <td class="txt">${row["Product Type"] ?? ""}</td>
        <td class="txt">${row.Room ?? ""}</td>
        <td class="num">${fmtPct(row.THC ?? 0)}</td>
        <td class="num"><b>${fmtPct(row["Total Terpenes"] ?? 0)}</b></td>
        ${terpCells}
      `;
      tbody.appendChild(tr);
    });

    setStatus("ok", `JS status: RUNNING ✅ (rows: ${data.length})`);
  } catch (err) {
    console.error(err);
    setStatus("bad", `JS ERROR: ${err.message}`);
  }
})();
</script>

</body>
</html>
